---
transition: "slide"
title: "è¬›ç¾©ã®é€£çµ¡ã‚’è‡ªå‹•åŒ–ã—ãŸè©±"
---

è¬›ç¾©ã®é€£çµ¡ã‚’è‡ªå‹•åŒ–ã—ãŸè©±

<div style="display:flex;justify-content:space-evenly;background:lightgray;">
<img src="https://uxwing.com/wp-content/themes/uxwing/download/10-brands-and-social-media/google-cloud-run.png" alt="" style="height:150px;">
<img src="https://www.b-ridges.com/wordpress/wp-content/uploads/2021/04/node-js-icon-resize.png" alt="" style="height:150px;">
<img src="https://auxworks.com/wp-content/uploads/2021/07/Sheets_Product_Icon_512dp.png" alt="" style="height:150px;">
<img src="https://digitalization-support.com/wp-content/uploads/2020/11/icon_slack.png" alt="" style="height:150px;">
</div>

---

ã‚‚ãã˜

- è‡ªå·±ç´¹ä»‹

- ç¾çŠ¶ã¨å›°ã‚Šã”ã¨

- ã‚„ã£ãŸã“ã¨

- ä½¿ã£ãŸæŠ€è¡“

---

è‡ªå·±ç´¹ä»‹

--

|         |                                      |
| ------- | ------------------------------------ |
| Name    | å¤§æ‰å¤ªéƒï¼ˆãŸã‚ã•ã‚“ï¼ŒãŸã‚å…ˆç”Ÿï¼‰       |
| Age     | 1987 å¹´ç”Ÿã¾ã‚Œ                        |
| Place   | èŒ¨åŸçœŒ -> åŒ—æµ·é“ -> æ±äº¬éƒ½ -> ç¦å²¡çœŒ |
| Career  | ã‚¸ãƒ¼ã‚ºã‚¢ã‚«ãƒ‡ãƒŸãƒ¼ç¦å²¡ä¸»ä»»è¬›å¸«         |
| Like1   | Rustï¼ŒNode.jsï¼Œæœ¬ï¼Œæ—…è¡Œï¼Œæ–­æ¨é›¢      |
| Like2   | ğŸ¥ƒ, ğŸº, ğŸ·                           |
| twitter | @taroosg                             |

---

ç¾çŠ¶ã¨å›°ã‚Šã”ã¨

--

3 - 4 ãƒ¶æœˆã®ã‚³ãƒ¼ã‚¹ã‚’å¹´ 2 - 3 å›å®Ÿæ–½

ï¼ˆJavaScript ã¨ PHP ãƒ¡ã‚¤ãƒ³ï¼Œã ã„ãŸã„æ¯å›åŒã˜ï¼‰

--

è¬›ç¾©ã«ã¯æ¡ˆå†…ãŒå¿…è¦

ï¼ˆSlack ã§å®Ÿæ–½ï¼‰

--

- æ¬¡å›ã¾ã§ã«å¿…è¦ãªæº–å‚™

- æ˜æ—¥ã®è¬›ç¾©ã®å†…å®¹

- etc

--

å¤šã„ï¼ˆã—ã‹ã‚‚å¤§ä½“åŒã˜å†…å®¹ï¼‰

| æ›œæ—¥ | è¬›ç¾©æœ‰ç„¡ | å¿…è¦ãªä½œæ¥­                 |
| ---- | -------- | -------------------------- |
| æœˆ   |          |                            |
| ç«   | è¬›ç¾©     | è¬›ç¾©è³‡æ–™ã®å±•é–‹ï¼Œè¬›ç¾©ã®æ¡ˆå†… |
| æ°´   |          | æ¬¡å›è¬›ç¾©ã®æ¡ˆå†…             |
| æœ¨   |          |                            |
| é‡‘   | è¬›ç¾©     | è¬›ç¾©è³‡æ–™ã®å±•é–‹ï¼Œè¬›ç¾©ã®æ¡ˆå†… |
| åœŸ   | è¬›ç¾©     | è¬›ç¾©è³‡æ–™ã®å±•é–‹ï¼Œè¬›ç¾©ã®æ¡ˆå†… |
| æ—¥   |          | æ¬¡å›è¬›ç¾©ã®æ¡ˆå†…             |

--

```
ï¼¿äººäººäººäººäººäººäººäººäººäººäººäººäººäººäººï¼¿
ï¼ã€€å®šå‹çš„ãªæŠ•ç¨¿ãŒã‚ã‚“ã©ãã•ã„ã€€ï¼œ
ï¿£Y^Y^Y^Y^Y^Y^Y^Y^Y^Y^Y^Y^Yï¿£
```

--

```
ï¼¿äººäººäººäººäººäººäººäººäººäººäººäººäººäººäººï¼¿
ï¼ã€€ãã†ã ï¼Œbotã«ã‚„ã£ã¦ã‚‚ã‚‰ãŠã†ã€€ï¼œ
ï¿£Y^Y^Y^Y^Y^Y^Y^Y^Y^Y^Y^Y^Yï¿£
```

---

ã‚„ã£ãŸã“ã¨

--

å¿…è¦ãªè¦ä»¶

--

- æŠ•ç¨¿å†…å®¹ã¯ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã§ç®¡ç†ã™ã‚‹ï¼

  - æŠ•ç¨¿ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆï¼Œæ—¥æ™‚ï¼Œãªã©

- ã‚·ãƒ¼ãƒˆã®å†…å®¹ã«å¾“ã£ã¦è‡ªå‹•æŠ•ç¨¿ã™ã‚‹ï¼

- æ¬¡å›ä»¥é™ã®æŠ•ç¨¿å†…å®¹ã‚’å¤‰æ›´ã—ãŸã‚‰åæ˜ ã•ã‚Œã‚‹ï¼

--

æ–¹é‡

--

1. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«æŠ•ç¨¿ã™ã‚‹å†…å®¹ã¨æ—¥æ™‚ã‚’æ›¸ã„ã¦ãŠãï¼

2. æ¯æ—¥ node.js ã§ãƒ‡ãƒ¼ã‚¿å–å¾—ã—ã¦ï¼Œæ—¥æ™‚ãŒå½“æ—¥ã®ã‚‚ã®ã‚’ Slack ã«äºˆç´„æŠ•ç¨¿ã™ã‚‹ï¼

---

ä½¿ç”¨æŠ€è¡“

--

![botå›³](./img/slack-automator.svg)

--

ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã‚³ãƒ¼ãƒ‰

--

```js
// ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹é–¢æ•°

const execAPI = async (spreadsheetId, range) => {
  const auth = await google.auth.getClient({
    scopes: ["https://www.googleapis.com/auth/spreadsheets.readonly"],
  });

  const apiOptions = {
    auth,
    spreadsheetId,
    range,
  };

  const result = await sheets.spreadsheets.values.get(apiOptions);
  return result.data.values;
};
```

--

```js
// ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®å¿…è¦ãªè¡Œã®ã¿æŠ½å‡ºã—ã¦æ•´å½¢ã™ã‚‹é–¢æ•°

export const createFantasticData = (rawData) =>
  rawData
    .filter((x, i, arr) => i !== 0 && hasEmpty(x) && hasColumn(x, arr[0]))
    .map((x, i) =>
      Object.fromEntries(
        x.map((x, i) => [
          rawData[0][i],
          ["year", "month", "day", "hour", "minute", "seconds"].includes(
            rawData[0][i]
          )
            ? Number(x)
            : x,
        ])
      )
    );
```

--

```js
// ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã„ã„æ„Ÿã˜ã®å½¢ã«ã™ã‚‹

const getSheetData = async () =>
  createFantasticData(await execAPI(process.env.SPREADSHEET_ID, "data"));
```

--

Slack ã«è‡ªå‹•ã§äºˆç´„æŠ•ç¨¿ã™ã‚‹ã‚³ãƒ¼ãƒ‰

--

```js
// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸äºˆç´„æŠ•ç¨¿ã™ã‚‹é–¢æ•°

const postToSlackScheduled = async (token, post_at, channel, text) => {
  const client = new WebClient(token);
  try {
    return await client.chat.scheduleMessage({ channel, text, post_at });
  } catch (error) {
    console.error(error);
    return error;
  }
};
```

--

```js
// ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å…¥åŠ›ã—ã¦æœ¬æ—¥ã®ã‚‚ã®ã ã‘å‡ºåŠ›ã™ã‚‹é–¢æ•°
const getTodaySchedules = (schedules) => {
  const todayObject = Object.fromEntries(
    format(
      process.env.DEPLOY === "production"
        ? addHours(new Date(), 9)
        : new Date(),
      "yyyy-M-d"
    )
      .split("-")
      .map((x, i) => [["year", "month", "day"][i], Number(x)])
  );

  return schedules.filter((x) =>
    [
      x.year === todayObject.year,
      x.month === todayObject.month,
      x.day === todayObject.day,
    ].every((x) => x)
  );
};
```

--

```js
// ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å…¥åŠ›ã™ã‚‹ã¨æœ¬æ—¥ã®ã‚‚ã®ã ã‘é€ä¿¡ã™ã‚‹é–¢æ•°
const scheduleAll = (schedules) => {
  const todaysSchedules = getTodaySchedules(schedules);

  todaysSchedules.forEach((x) =>
    postToSlackScheduled(
      x.token,
      process.env.DEPLOY === "production"
        ? getUnixTime(
            new Date(x.year, x.month - 1, x.day, x.hour, x.minute, x.seconds)
          ) -
            60 * 60 * 9
        : getUnixTime(
            new Date(x.year, x.month - 1, x.day, x.hour, x.minute, x.seconds)
          ),
      x.channel,
      x.text
    )
  );
  return;
};
```

--

è¬›ç¾©ã¨è³‡æ–™ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã ã‘ã«ãªã£ãŸï¼

| æ›œæ—¥ | è¬›ç¾©æœ‰ç„¡ | å¿…è¦ãªä½œæ¥­     |
| ---- | -------- | -------------- |
| æœˆ   |          |                |
| ç«   | è¬›ç¾©     | è¬›ç¾©è³‡æ–™ã®å±•é–‹ |
| æ°´   |          |                |
| æœ¨   |          |                |
| é‡‘   | è¬›ç¾©     | è¬›ç¾©è³‡æ–™ã®å±•é–‹ |
| åœŸ   | è¬›ç¾©     | è¬›ç¾©è³‡æ–™ã®å±•é–‹ |
| æ—¥   |          |                |

--

ï¼ˆGAS ã§ã‚„ã‚Œã°çµ¶å¯¾ã‚‚ã£ã¨ç°¡å˜ wï¼‰

---

ä»¥ä¸Šã ( `ï½¥Ï‰ï½¥)b
